# 跳回 APP 场景值获取

<a name="e6cefb85"></a>
### 需求
- 小程序直接访问时，场景值为 1001，不显示跳回 APP 按钮
- 小程序通过 APP 分享卡片打开时，场景值为 1036 ，显示跳回 APP 按钮

<a name="5dc99f6e"></a>
### 问题

- 根据文档中所说，onShow 的回调参数中会带有当前场景值，结果发现 Page 的 onShow 没有回调参数
- 在 Page 内使用 wx.getLaunchOptionsSync 获取到的场景值不会改变，如果第一次进入小程序时，场景值为 1036，那么后面获取到的场景值都为 1036，导致即使从微信内分享的小程序卡片打开，也同样被认为是从 APP 分享过来的
- 在 Page 中添加 onAppShow 事件，回调参数中的场景值为正确场景值，然而执行 setData 后，数据更新，但是视图不刷新，已排除 this 指向错误的问题

<a name="81c1dff6"></a>
### 解决办法
文档描述有误，onShow 只有在 app.js 内，也就是小程序的 App 下，才会有回调参数，此时的回调参数为正确的回调参数，将该参数设置在 App 的全局变量中，然后在各 Page 的 onShow 中，通过 getApp() 来获取场景值并进行 setData 操作，数据更新，视图更新
